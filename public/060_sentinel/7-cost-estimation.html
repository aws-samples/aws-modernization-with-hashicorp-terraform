<!DOCTYPE html>
<html lang="oyo" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.85.0" />
    <meta name="description" content="AWS Modernization Workshop">
<meta name="author" content="James Bland">

    <link rel="icon" href="/images/favicon.png" type="image/png">

    <title>Control Costs with Policies :: MP DevOps Series</title>

    
    <link href="/css/nucleus.css?1626962734" rel="stylesheet">
    <link href="/css/fontawesome-all.min.css?1626962734" rel="stylesheet">
    <link href="/css/hybrid.css?1626962734" rel="stylesheet">
    <link href="/css/featherlight.min.css?1626962734" rel="stylesheet">
    <link href="/css/perfect-scrollbar.min.css?1626962734" rel="stylesheet">
    <link href="/css/auto-complete.css?1626962734" rel="stylesheet">
    <link href="/css/atom-one-dark-reasonable.css?1626962734" rel="stylesheet">
    <link href="/css/theme.css?1626962734" rel="stylesheet">
    <link href="/css/hugo-theme.css?1626962734" rel="stylesheet">
    
    <link href="/css/theme-mine.css?1626962734" rel="stylesheet">
    
    

    <script src="/js/jquery-3.3.1.min.js?1626962734"></script>

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
    </style>
    <script type="text/javascript">
    (function() {
          var didInit = false;
          function initMunchkin() {
              if (didInit === false) {
                didInit = true;
                Munchkin.init("112-TZM-766", { domainLevel: 3 });
              }
          }
          var s = document.createElement('script');
          s.type = 'text/javascript';
          s.async = true;
          s.src = '//munchkin.marketo.net/munchkin.js';
          s.onreadystatechange = function() {
              if (this.readyState == 'complete' || this.readyState == 'loaded') {
                  initMunchkin();
              }
          };
          s.onload = initMunchkin;
          document.getElementsByTagName('head')[0].appendChild(s);
    })();
</script>

<link rel="stylesheet" href="/css/mp-devops-series.css">
<link rel="stylesheet" href="https://pages.awscloud.com/js/forms2/css/forms2.css">

  </head>
  <body class="" data-url="/060_sentinel/7-cost-estimation.html">
    <nav id="sidebar" class="showVisitedLinks">



  <div id="header-wrapper">
    <div id="header">
      <a href="/" title="Go home"><svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 30" width="60%" style="padding:20px 0px;"><defs><style>.cls-1{fill:#fff;}.cls-2{fill:#f90;fill-rule:evenodd;}</style></defs><title>AWS-Logo_White-Color</title><path class="cls-1" d="M14.09,10.85a4.7,4.7,0,0,0,.19,1.48,7.73,7.73,0,0,0,.54,1.19.77.77,0,0,1,.12.38.64.64,0,0,1-.32.49l-1,.7a.83.83,0,0,1-.44.15.69.69,0,0,1-.49-.23,3.8,3.8,0,0,1-.6-.77q-.25-.42-.51-1a6.14,6.14,0,0,1-4.89,2.3,4.54,4.54,0,0,1-3.32-1.19,4.27,4.27,0,0,1-1.22-3.2A4.28,4.28,0,0,1,3.61,7.75,6.06,6.06,0,0,1,7.69,6.46a12.47,12.47,0,0,1,1.76.13q.92.13,1.91.36V5.73a3.65,3.65,0,0,0-.79-2.66A3.81,3.81,0,0,0,7.86,2.3a7.71,7.71,0,0,0-1.79.22,12.78,12.78,0,0,0-1.79.57,4.55,4.55,0,0,1-.58.22l-.26,0q-.35,0-.35-.52V2a1.09,1.09,0,0,1,.12-.58,1.2,1.2,0,0,1,.47-.35A10.88,10.88,0,0,1,5.77.32,10.19,10.19,0,0,1,8.36,0a6,6,0,0,1,4.35,1.35,5.49,5.49,0,0,1,1.38,4.09ZM7.34,13.38a5.36,5.36,0,0,0,1.72-.31A3.63,3.63,0,0,0,10.63,12,2.62,2.62,0,0,0,11.19,11a5.63,5.63,0,0,0,.16-1.44v-.7a14.35,14.35,0,0,0-1.53-.28,12.37,12.37,0,0,0-1.56-.1,3.84,3.84,0,0,0-2.47.67A2.34,2.34,0,0,0,5,11a2.35,2.35,0,0,0,.61,1.76A2.4,2.4,0,0,0,7.34,13.38Zm13.35,1.8a1,1,0,0,1-.64-.16,1.3,1.3,0,0,1-.35-.65L15.81,1.51a3,3,0,0,1-.15-.67.36.36,0,0,1,.41-.41H17.7a1,1,0,0,1,.65.16,1.4,1.4,0,0,1,.33.65l2.79,11,2.59-11A1.17,1.17,0,0,1,24.39.6a1.1,1.1,0,0,1,.67-.16H26.4a1.1,1.1,0,0,1,.67.16,1.17,1.17,0,0,1,.32.65L30,12.39,32.88,1.25A1.39,1.39,0,0,1,33.22.6a1,1,0,0,1,.65-.16h1.54a.36.36,0,0,1,.41.41,1.36,1.36,0,0,1,0,.26,3.64,3.64,0,0,1-.12.41l-4,12.86a1.3,1.3,0,0,1-.35.65,1,1,0,0,1-.64.16H29.25a1,1,0,0,1-.67-.17,1.26,1.26,0,0,1-.32-.67L25.67,3.64,23.11,14.34a1.26,1.26,0,0,1-.32.67,1,1,0,0,1-.67.17Zm21.36.44a11.28,11.28,0,0,1-2.56-.29,7.44,7.44,0,0,1-1.92-.67,1,1,0,0,1-.61-.93v-.84q0-.52.38-.52a.9.9,0,0,1,.31.06l.42.17a8.77,8.77,0,0,0,1.83.58,9.78,9.78,0,0,0,2,.2,4.48,4.48,0,0,0,2.43-.55,1.76,1.76,0,0,0,.86-1.57,1.61,1.61,0,0,0-.45-1.16A4.29,4.29,0,0,0,43,9.22l-2.41-.76A5.15,5.15,0,0,1,38,6.78a3.94,3.94,0,0,1-.83-2.41,3.7,3.7,0,0,1,.45-1.85,4.47,4.47,0,0,1,1.19-1.37A5.27,5.27,0,0,1,40.51.29,7.4,7.4,0,0,1,42.6,0a8.87,8.87,0,0,1,1.12.07q.57.07,1.08.19t.95.26a4.27,4.27,0,0,1,.7.29,1.59,1.59,0,0,1,.49.41.94.94,0,0,1,.15.55v.79q0,.52-.38.52a1.76,1.76,0,0,1-.64-.2,7.74,7.74,0,0,0-3.2-.64,4.37,4.37,0,0,0-2.21.47,1.6,1.6,0,0,0-.79,1.48,1.58,1.58,0,0,0,.49,1.18,4.94,4.94,0,0,0,1.83.92L44.55,7a5.08,5.08,0,0,1,2.57,1.6A3.76,3.76,0,0,1,47.9,11a4.21,4.21,0,0,1-.44,1.93,4.4,4.4,0,0,1-1.21,1.47,5.43,5.43,0,0,1-1.85.93A8.25,8.25,0,0,1,42.05,15.62Z"></path><path class="cls-2" d="M45.19,23.81C39.72,27.85,31.78,30,25,30A36.64,36.64,0,0,1,.22,20.57c-.51-.46-.06-1.09.56-.74A49.78,49.78,0,0,0,25.53,26.4,49.23,49.23,0,0,0,44.4,22.53C45.32,22.14,46.1,23.14,45.19,23.81Z"></path><path class="cls-2" d="M47.47,21.21c-.7-.9-4.63-.42-6.39-.21-.53.06-.62-.4-.14-.74,3.13-2.2,8.27-1.57,8.86-.83s-.16,5.89-3.09,8.35c-.45.38-.88.18-.68-.32C46.69,25.8,48.17,22.11,47.47,21.21Z"></path></svg></a>

    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="/js/lunr.min.js?1626962734"></script>
<script type="text/javascript" src="/js/auto-complete.js?1626962734"></script>
<script type="text/javascript">
    
        var baseurl = "\/";
    
</script>
<script type="text/javascript" src="/js/search.js?1626962734"></script>

    
  </div>
  
    <section id="homelinks">
      <ul>
        <li>
            <a class="padding" href='/'><i class='fas fa-home'></i> Home</a>
        </li>
      </ul>
    </section>
  

    <div class="highlightable">
    <ul class="topics">

        
          
          




 
  
    
    <li data-nav-id="/010_introduction.html" title="Introduction" class="dd-item
        
        
        
        ">
      <a href="/010_introduction.html">
          Introduction
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/010_introduction/10_foreword.html" title="Foreword" class="dd-item ">
        <a href="/010_introduction/10_foreword.html">
        Foreword
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/010_introduction/12_problem_to_solve.html" title="Problem Statement" class="dd-item ">
        <a href="/010_introduction/12_problem_to_solve.html">
        Problem Statement
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/010_introduction/14_partner.html" title="Who is this partner?" class="dd-item ">
        <a href="/010_introduction/14_partner.html">
        Who is this partner?
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/010_introduction/16_workshop_next_step.html" title="Workshop Next Steps" class="dd-item ">
        <a href="/010_introduction/16_workshop_next_step.html">
        Workshop Next Steps
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/030_self_guided_setup.html" title="Self Guided Setup" class="dd-item
        
        
        
        ">
      <a href="/030_self_guided_setup.html">
          Self Guided Setup
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/030_self_guided_setup/30_aws_setup_your_own.html" title="1. AWS Account Setup" class="dd-item ">
        <a href="/030_self_guided_setup/30_aws_setup_your_own.html">
        1. AWS Account Setup
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/030_self_guided_setup/32_request_credit.html" title="2. AWS Credit Request" class="dd-item ">
        <a href="/030_self_guided_setup/32_request_credit.html">
        2. AWS Credit Request
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/030_self_guided_setup/34_start_cloud9workspace.html" title="3. Create a Workspace" class="dd-item ">
        <a href="/030_self_guided_setup/34_start_cloud9workspace.html">
        3. Create a Workspace
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/030_self_guided_setup/36_config_workshop_req.html" title="5. Configure workshop specific requirements" class="dd-item ">
        <a href="/030_self_guided_setup/36_config_workshop_req.html">
        5. Configure workshop specific requirements
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/040_terraform_cloud_setup.html" title="Terraform Cloud Setup" class="dd-item
        
        
        
        ">
      <a href="/040_terraform_cloud_setup.html">
          Terraform Cloud Setup
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/040_terraform_cloud_setup/1-cloud-sign-up.html" title="Sign up for Terraform Cloud" class="dd-item ">
        <a href="/040_terraform_cloud_setup/1-cloud-sign-up.html">
        Sign up for Terraform Cloud
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/040_terraform_cloud_setup/2-cloud-workspace-create.html" title="Create a Workspace" class="dd-item ">
        <a href="/040_terraform_cloud_setup/2-cloud-workspace-create.html">
        Create a Workspace
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/050_deploying_infrastructure.html" title="Deploying Infrastructure" class="dd-item
        
        
        
        ">
      <a href="/050_deploying_infrastructure.html">
          Deploying Infrastructure
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/050_deploying_infrastructure/3-cloud-workspace-configure.html" title="Create Infrastructure" class="dd-item ">
        <a href="/050_deploying_infrastructure/3-cloud-workspace-configure.html">
        Create Infrastructure
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/050_deploying_infrastructure/4-cloud-change.html" title="Change Infrastructure" class="dd-item ">
        <a href="/050_deploying_infrastructure/4-cloud-change.html">
        Change Infrastructure
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/050_deploying_infrastructure/5-cloud-destroy.html" title="Destroy Resources and Workspaces" class="dd-item ">
        <a href="/050_deploying_infrastructure/5-cloud-destroy.html">
        Destroy Resources and Workspaces
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/060_sentinel.html" title="Sentinel" class="dd-item
        parent
        
        
        ">
      <a href="/060_sentinel.html">
          Sentinel
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/060_sentinel/6-policy-quickstart.html" title="Enforce a Policy" class="dd-item ">
        <a href="/060_sentinel/6-policy-quickstart.html">
        Enforce a Policy
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/060_sentinel/7-cost-estimation.html" title="Control Costs with Policies" class="dd-item active">
        <a href="/060_sentinel/7-cost-estimation.html">
        Control Costs with Policies
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/090_cleanup.html" title="Cleanup" class="dd-item
        
        
        
        ">
      <a href="/090_cleanup.html">
          Cleanup
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/099_survey.html" title="Survey" class="dd-item
        
        
        
        ">
      <a href="/099_survey.html">
          Survey
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
    </li>
  
 

          
        
    </ul>

    
    
      <section id="shortcuts">
        <h3></h3>
        <ul>
          
              <li>
                  <a class="padding" href="https://awsworkshop.io"><i class='fas fa-graduation-cap'></i> Modernization Workshops</a>
              </li>
          
              <li>
                  <a class="padding" href="https://aws.amazon.com/builders-library/"><i class='fas fa-tools'></i> AWS Builders Library</a>
              </li>
          
              <li>
                  <a class="padding" href="https://aws.amazon.com/blogs/modernizing-with-aws/"><i class='far fa-lightbulb'></i> Modernization with AWS</a>
              </li>
          
              <li>
                  <a class="padding" href="https://eksworkshop.com/"><i class='fas fa-chalkboard-teacher'></i> EKS Workshop</a>
              </li>
          
              <li>
                  <a class="padding" href="https://ecsworkshop.com/"><i class='fas fa-chalkboard-teacher'></i> ECS Workshop</a>
              </li>
          
              <li>
                  <a class="padding" href="https://www.appmeshworkshop.com/"><i class='fas fa-chalkboard-teacher'></i> App Mesh Workshop</a>
              </li>
          
        </ul>
      </section>
    

    
    <section id="prefooter">
      <hr/>
      <ul>
      
        <li>
          <a class="padding">
            <i class="fas fa-language fa-fw"></i>
          <div class="select-style">
            <select id="select-language" onchange="location = this.value;">
          
          
          
              
              
                  
                    
                    
                      <option id="oyo" value="/060_sentinel/7-cost-estimation.html" selected>MP DevOps Series</option>
                    
                  
              
                  
              
          
        </select>
        <svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
          width="255px" height="255px" viewBox="0 0 255 255" style="enable-background:new 0 0 255 255;" xml:space="preserve">
          <g>
            <g id="arrow-drop-down">
              <polygon points="0,63.75 127.5,191.25 255,63.75 		" />
            </g>
          </g>
        </svg>
        </div>
        </a>
        </li>
      

      
        <li><a class="padding" href="#" data-clear-history-toggle=""><i class="fas fa-history fa-fw"></i> </a></li>
      
      </ul>
    </section>
    
    <section id="footer">
      <left>

    <a href="https://aws.amazon.com/privacy/?nc1=f_pr">Privacy</a> | <a
        href="https://aws.amazon.com/terms/?nc1=f_pr">Site Terms</a> | Â© 2021, Amazon Web Services, Inc. or its
    affiliates. All rights reserved.

</left>
    </section>
  </div>
</nav>




        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            
            
          
          
            <a href='/'>AWS Modernization Workshop</a> > <a href='/060_sentinel.html'>Sentinel</a> > Control Costs with Policies
          
        
          
        
          
        
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#prerequisites">Prerequisites</a></li>
<li><a href="#fork-the-sample-repository">Fork the sample repository</a></li>
<li><a href="#create-a-terraform-cloud-workspace">Create a Terraform Cloud workspace</a></li>
<li><a href="#configure-workspace-variables">Configure workspace variables</a></li>
<li><a href="#verify-costs-using-policies">Verify costs using policies</a></li>
<li><a href="#create-a-policy-set">Create a policy set</a></li>
<li><a href="#trigger-a-run">Trigger a run</a></li>
<li><a href="#view-cost-estimate">View cost estimate</a></li>
<li><a href="#delete-the-policy-set">Delete the policy set</a></li>
<li><a href="#delete-workspace">Delete workspace</a></li>
<li><a href="#next-steps">Next steps</a></li>
</ul></li>
</ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        
        </div>
        
        <div id="body-inner">
          
            <h1>
              
              Control Costs with Policies
            </h1>
          

        




<hr />

<p>Terraform Cloud estimates costs for many resources found in your Terraform
configuration. It displays an hourly and monthly cost for each resource, and the monthly delta. It also totals the cost and delta of all estimatable
resources.</p>

<p>In this tutorial, you will enable cost estimation and define policy to check whether the total monthly delta is less than one hundred dollars a month.</p>


<div class="notices note" ><p>This functionality is available in the Terraform Cloud <a href="https://www.hashicorp.com/products/terraform/pricing/" target="_blank">Team &amp; Governance</a> tier, as well as <a href="https://www.hashicorp.com/products/terraform/pricing/" target="_blank">Enterprise</a>. Organization owners can enable a <a href="https://www.hashicorp.com/blog/announcing-free-trials-for-hashicorp-terraform-cloud-paid-offerings/" target="_blank">30-day free trial</a> in their settings under <strong>&ldquo;Plan &amp; Billing&rdquo;</strong>. Cost estimates are not available for workspaces using versions of Terraform less than 0.12.0.</p>
</div>


<h2 id="prerequisites">Prerequisites</h2>

<p>For this tutorial you will need:</p>

<ul>
<li>A Terraform Cloud Team &amp; Governance tier account or a Terraform Enterprise account</li>
<li>A <a href="https://github.com/" target="_blank">GitHub account</a></li>
<li>An <a href="https://aws.amazon.com/" target="_blank">AWS account to create example resources</a></li>
</ul>

<p>You should also be familiar with how to <a href="2-cloud-workspace-create.md" target="_blank">create</a> and <a href="5-cloud-destroy.md#delete-the-workspace-optional" target="_blank">destroy</a> Terraform Cloud workspaces.</p>


<div class="notices warning" ><p>Do not apply this policy to a production workspace as it may impact your production environment.</p>
</div>



<div class="notices note" ><p>Terraform Cloud will not estimate cost on runs or applies <a href="https://www.terraform.io/docs/cli/commands/plan.html#resource-targeting" target="_blank">targeted against a subset of resources</a>.</p>
</div>


<h2 id="fork-the-sample-repository">Fork the sample repository</h2>

<p>Fork the <a href="https://github.com/hashicorp/learn-sentinel-tfc" target="_blank">sample repository</a>, which contains an example Terraform configuration to provision an EC2 instance.</p>

<p><img src="/images/hashicorp/terraform/github_hashicorp_learn-sentinel-tfc_fork.png" alt="Fork learn-sentinel-tfc repository" /></p>

<p>Navigate to the <code>versions.tf</code> file in <strong>your fork</strong> of the repository in the Github web UI, and click the pencil icon in the top right corner.</p>

<p><img src="/images/hashicorp/terraform/github_learn-sentinel-tfc_blob_master_versions_file.png" alt="Edit versions.tf file in Github" /></p>

<p>In the backend configuration block, replace <code>&quot;&lt;YOUR_TERRAFORM_ORG&gt;&quot;</code> with the name of your Terraform Cloud organization. Commit the change.</p>

<h2 id="create-a-terraform-cloud-workspace">Create a Terraform Cloud workspace</h2>

<p>Navigate to your Terraform Cloud organization and create a new VCS-backed
workspace connected to your fork of the <code>learn-sentinel-tfc</code> repository.</p>


<div class="notices note" ><p>If you completed the <a href="zz-/sentinel-cloud-integration.md" target="_blank">Upload Your Sentinel Policy Set to Terraform Cloud tutorial</a>, you may already have a workspace for this configuration. Feel free to use it.</p>
</div>


<h2 id="configure-workspace-variables">Configure workspace variables</h2>

<ol>
<li>Navigate to your <code>learn-sentinel-tfc</code> workspace&rsquo;s <strong>&ldquo;Variables&rdquo;</strong> page</li>
<li>Define a variable called <code>instance_type</code> and set the value to <code>t2.large</code>.</li>
<li>Define environment variables for your <code>AWS_ACCESS_KEY_ID</code> and <code>AWS_SECRET_ACCESS_KEY</code>. Be sure to set both as <code>sensitive</code>.</li>
</ol>

<p>When complete, your variable definitions will match the following:</p>

<p><img src="/images/hashicorp/terraform/tfc_hashicorp-training_workspaces_learn-sentinel-tfc_variables.png" alt="Terraform Cloud workspace variables" /></p>

<h2 id="verify-costs-using-policies">Verify costs using policies</h2>

<p>To verify cost estimates using policies, you need to define your policy and update your policy set.</p>

<p>Create a fork of the <a href="https://github.com/hashicorp/learn-terraform-cost-estimation" target="_blank">example repository</a>, which contains a Sentinel policy that flags any resource changes that increase costs by greater than \$100.</p>

<p>The <code>sentinel.hcl</code> file in this repository declares the new policy in your policy set. Note that the <code>enforcement_level</code> is set to <code>soft-mandatory</code>: this allows team members with explicitly set permission to override the policy check and logs and overrides.</p>
<pre><code class="language-sentinel" data-lang="sentinel">policy &#34;less-than-100-month&#34; {
  enforcement_level = &#34;soft-mandatory&#34;
}</code></pre>
<p>The <code>less-than-100-month.sentinel</code> file contains the policy definition.</p>
<pre><code class="language-sentinel" data-lang="sentinel">import &#34;tfrun&#34;
import &#34;decimal&#34;

delta_monthly_cost = decimal.new(tfrun.cost_estimate.delta_monthly_cost)

main = rule {
    delta_monthly_cost.less_than(100)
}</code></pre>
<p>This policy uses the <a href="https://www.terraform.io/docs/cloud/sentinel/import/tfrun.html" target="_blank">tfrun</a> import to check that the cost delta for a Terraform run is no more than \$100. The <code>decimal</code> import is used for more precise calculations when working with currency numbers.</p>

<p>Terraform Cloud will run checks for policies defined in <code>sentinel.hcl</code> in all workspaces associated with the policy set.</p>

<h2 id="create-a-policy-set">Create a policy set</h2>

<p>In Terraform Cloud, navigate to <strong>&ldquo;Settings&rdquo; &gt; &ldquo;Policy Sets&rdquo;</strong> and select <strong>&ldquo;Connect a new policy set&rdquo;</strong>. Configure <strong>your fork</strong> of the <code>learn-terraform-cost-estimation</code> repository as the source.</p>


<div class="notices tip" ><p>The search bar for policy repositories is case sensitive.</p>
</div>


<p>In Terraform Cloud, you can apply policy sets either across your organization, or to specific workspaces.</p>

<p>On the <strong>&ldquo;Configure Settings&rdquo;</strong> page:</p>

<ol>
<li>Select <strong>&ldquo;Policies enforced on selected workspaces&rdquo;</strong> under <strong>&ldquo;Scope of Policies&rdquo;</strong></li>
<li>Select your <code>learn-sentinel-tfc</code> workspace and click the purple <strong>&ldquo;Add workspace button&rdquo;</strong></li>
<li>Click <strong>&ldquo;Connect policy set&rdquo;</strong></li>
</ol>

<p><img src="/images/hashicorp/terraform/tfc_hashicorp-training_settings_configure_policy_set.png" alt="Configure policy set workspaces" /></p>

<h2 id="trigger-a-run">Trigger a run</h2>


<div class="notices tip" ><p>For a full list of supported resources in Terraform Cloud cost estimation, refer to the <a href="https://www.terraform.io/docs/cloud/cost-estimation/aws.html" target="_blank">AWS</a> Cost Estimation Documentation.</p>
</div>


<p>Navigate to your <code>learn-sentinel-tfc</code> workspace. Select <strong>&ldquo;Start new plan&rdquo;</strong> from the <strong>&ldquo;Actions&rdquo;</strong> menu, and run the default <strong>&ldquo;Plan (most common)&rdquo;</strong> option.</p>

<p><img src="/images/hashicorp/terraform/tfc_hashicorp-training_workspaces_learn-sentinel-tfc_start_plan.png" alt="Start a Terraform Cloud plan run" /></p>

<h2 id="view-cost-estimate">View cost estimate</h2>

<p>After queueing a new run, Terraform Cloud will estimate changes to your
resource costs and display them in the run UI. There you will find the list of resources, their price details, and the list of un-estimated resources. You will also find the new total to determine the proposed overall monthly cost once the run is applied.</p>

<p>In this case, the new resource definition satisfies the Sentinel policy check you defined.</p>


<div class="notices note" ><p>This is just an estimate; some resources do not have cost information available or have unpredictable usage-based pricing.</p>
</div>


<p><img src="/images/hashicorp/terraform/tfc_hashicorp-training_workspaces_learn-sentinel-tfc_cost_estimate_passed.png" alt="Terraform Cloud cost estimation Sentinel check passed" /></p>

<p>Click <strong>&ldquo;Discard run&rdquo;</strong> to cancel the run.</p>

<h2 id="delete-the-policy-set">Delete the policy set</h2>

<p>Navigate back to your policy set under <strong>&ldquo;Settings&rdquo; &gt; &ldquo;Policy Sets&rdquo;</strong>. Under workspaces, click <strong>&ldquo;Delete policy set&rdquo;</strong>. Confirm by clicking <strong>&ldquo;Yes, delete policy set&rdquo;</strong>.</p>

<p><img src="/images/hashicorp/terraform/tfc_hashicorp-training_settings_policy-sets_delete.png" alt="Delete Terraform Cloud policy set" /></p>

<h2 id="delete-workspace">Delete workspace</h2>

<p>If you do not plan on exploring other tutorials in this collection, you can
delete the workspace you created. Terraform Cloud does not charge per workspace, so you are free to leave it if you would like.</p>

<p>Under your workspace&rsquo;s <strong>&ldquo;Settings&rdquo;</strong> menu, select the <strong>&ldquo;Destruction and Deletion&rdquo;</strong> option and then delete the workspace.</p>

<h2 id="next-steps">Next steps</h2>

<p>Congratulations - you have enabled cost estimation and used it in a policy check! This provides another tool to manage your infrastructure spending.</p>

<p>To learn more about cost estimation, refer to the <a href="https://www.terraform.io/docs/cloud/cost-estimation/index.html" target="_blank">Cost Estimation documentation</a>.</p>

<p>If you would like to learn more about Terraform Cloud, refer to the following resources:</p>

<ul>
<li>Read the <a href="https://www.terraform.io/docs/cloud/index.html" target="_blank">Terraform Cloud documentation</a></li>
<li>Learn about the <a href="https://www.terraform.io/docs/cloud/overview.html" target="_blank">free and paid features of Terraform Cloud</a></li>
<li>Learn more about <a href="https://www.terraform.io/docs/cloud/cost-estimation/index.html" target="_blank">Cost Estimation Documentation</a></li>
<li>Read the <a href="https://www.terraform.io/docs/cloud/run/states.html" target="_blank">Run States Documentation</a>.</li>
</ul>


<footer class="footline">
	
</footer>

        
        </div>
        

      </div>

    <div id="navigation">
        
        

        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        

        


	 
	 
		
			<a class="nav nav-prev" href="/060_sentinel/6-policy-quickstart.html" title="Enforce a Policy"> <i class="fa fa-chevron-left"></i></a>
		
		
			<a class="nav nav-next" href="/090_cleanup.html" title="Cleanup" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
		
	
    </div>

    </section>

    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/js/clipboard.min.js?1626962734"></script>
    <script src="/js/perfect-scrollbar.min.js?1626962734"></script>
    <script src="/js/perfect-scrollbar.jquery.min.js?1626962734"></script>
    <script src="/js/jquery.sticky.js?1626962734"></script>
    <script src="/js/featherlight.min.js?1626962734"></script>
    <script src="/js/highlight.pack.js?1626962734"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/js/modernizr.custom-3.6.0.js?1626962734"></script>
    <script src="/js/learn.js?1626962734"></script>
    <script src="/js/hugo-learn.js?1626962734"></script>
    
        
            <script src="/mermaid/mermaid.js?1626962734"></script>
        
        <script>
            mermaid.initialize({ startOnLoad: true });
        </script>
    
    

  </body>
</html>

